ALTER TABLE MODULE_ENTITY ADD COLUMN MODULE_SYSTEM INTEGER;
ALTER TABLE ROLE ADD COLUMN MODULE_SYSTEM INTEGER;
ALTER TABLE OPTIONS ADD COLUMN URL VARCHAR(500);
ALTER TABLE PURCHASE_ORDER ADD COLUMN PROJECT_ID BIGINT;--DO IT NOT NULLABLE AND A FK.
ALTER TABLE USER_ROLE ADD COLUMN ID INTEGER; -- do it not nullable
ALTER TABLE USER_ROLE ADD COLUMN MODULE_SYSTEM INTEGER;

INSERT INTO PROJECT (PROJECT_NUMBER,ID,STATUS,LAST_UPDATE)
SELECT DISTINCT(PROJECT) AS NUM,ROW_NUMBER() OVER() AS ID, 0 AS ST,CURRENT_DATE
FROM PURCHASE_ORDER 
WHERE STATUS_ID=1;

UPDATE PURCHASE_ORDER SET PROJECT_ID =PR.ID FROM  PURCHASE_ORDER AS PO ,PROJECT AS PR WHERE PR.PROJECT_NUMBER=PO.PO ;

DELETE FROM USER_ROLE;

INSERT INTO USER_ROLE (ROLE_ID,USER_ID,MODULE_SYSTEM,ID)
SELECT ROLE_ID,ID,0,row_number() over()
FROM USERS
WHERE STATUS_ID=1;

delete from module_granted_access;
INSERT INTO MODULE_GRANTED_ACCESS (ID,USER_ID,MODULE_SYSTEM,MODULE_ACCESS)
SELECT row_number() over(),ID,0,TRUE
FROM USERS
WHERE STATUS_ID=1;

INSERT INTO MODULE_GRANTED_ACCESS (ID,USER_ID,MODULE_SYSTEM,MODULE_ACCESS)
SELECT row_number()  over()+26,ID,1,FALSE
FROM USERS
WHERE STATUS_ID=1;
--take care with 26  because it should be calculated according the total of active users; 



ALTER TABLE USERS DROP COLUMN ROLE_ID;
INSERT INTO USERS (ID,EMAIL,FIRST_NAME,NAME,PWD_HASH,STATUS_ID,USER_NAME,LAST_UPDATE)VALUES(128,'admin@info.com','ADMIN','ADMIN','jZae727K08KaOmKSgOaGzww/XVqGr/PKEgIMkjrcbJI=',1,'admin',CURRENT_DATE);
INSERT INTO MODULE_GRANTED_ACCESS (ID,USER_ID,MODULE_SYSTEM,MODULE_ACCESS)VALUES(53,128,0,TRUE);
INSERT INTO MODULE_GRANTED_ACCESS (ID,USER_ID,MODULE_SYSTEM,MODULE_ACCESS)VALUES(54,128,1,TRUE);



ALTER TABLE SUPPLIER_PROC ALTER COLUMN STREET TYPE VARCHAR(1000);

ALTER TABLE USERS ALTER COLUMN USER_NAME TYPE VARCHAR(250);
ALTER TABLE USERS ALTER COLUMN PWD_HASH TYPE VARCHAR(250);
ALTER TABLE USERS ALTER COLUMN NAME TYPE VARCHAR(250);
ALTER TABLE USERS ALTER COLUMN EMAIL TYPE VARCHAR(250);
ALTER TABLE USERS ALTER COLUMN FIRST_NAME TYPE VARCHAR(250);


INSERT INTO ROLE(id,name,module_system) VALUES (14,'FULL_WITH_COMMIT',1);
INSERT INTO ROLE(id,name,module_system) VALUES (15,'FULL',1);
INSERT INTO ROLE(id,name,module_system) VALUES (16,'RESTRICTED',1);
INSERT INTO ROLE(id,name,module_system) VALUES (17,'READ_ONLY',1);
INSERT INTO USER_ROLE (USER_ID,ROLE_ID,MODULE_SYSTEM) VALUES(128,14,1);
INSERT INTO USER_ROLE (USER_ID,ROLE_ID,MODULE_SYSTEM) VALUES(128,10,0);