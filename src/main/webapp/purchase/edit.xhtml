<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:o="http://omnifaces.org/ui"
                xmlns:p="http://primefaces.org/ui"
                xmlns:jsf="http://xmlns.jcp.org/jsf/passthrough"
                template="/WEB-INF/layout/template.xhtml">

<ui:define name="title">Inicio</ui:define>
<f:metadata>
    <f:viewAction action="#{identity.isLoggedIn()}"/>
    <f:viewParam name="poId" value="#{purchaseOrderEdit.purchaseOrderId}"/>
    <f:viewParam name="fase" value="#{purchaseOrderEdit.fase}"/>
    <f:viewAction action="#{permissionBean.canAccess(102)}"/>
    <f:viewAction action="#{purchaseOrderEdit.load}"/>

</f:metadata>
<ui:define name="body">
        <div class="row">
            <o:highlight/>

            <div class="col-lg-12">
                <h:form id="empForm" class="form-horizontal" role="form" prependId="false" enctype="multipart/form-data"
                        acceptcharset="UTF-8">
                <script>
                    $(document).ready(function() {
                        if (document.referrer != "") {
                            var referringURL = document.referrer;
                            if(referringURL.indexOf("purchase/modal/CreateModalScopeSupply.jsf") != -1){
                                console.log("is create scope supply");
                                hasChanges = true;
                            }else if(referringURL.indexOf("purchase/modal/CreateModalScopeSupplyEditing.jsf") != -1){
                                console.log("is create scope supply editing");
                                hasChanges = true;
                            }else if(referringURL.indexOf("purchase/modal/EditModalScopeSupply.jsf") != -1){
                                console.log("is edit scope supply")
                                hasChanges = true;
                            }else if(referringURL.indexOf("purchase/modal/EditModalScopeSupplyEditing.jsf") != -1){
                                console.log("is edit scope supply editing")
                                hasChanges = true;
                            }else if(referringURL.indexOf("purchase/modal/EditModalSplitScopeSupply.jsf") != -1){
                                console.log("is edit split scope supply")
                                hasChanges = true;
                            }
                        }
                    });
                </script>

                    <!-- Form Name -->
                <div class="title-page">
                    <h4 class="page-header">#{msgs['po.view.edit']}</h4>
                </div>
                <div class="clearfix"></div>
                <br/>
                <h4 class="sub-header">#{msgs['lbl.ph.title.general']}</h4>
                <br/>
                    <div class="row">
                        <div class="section-lbl-input-po">
                            <!-- Text input-->
                            <div class="form-group input-general-po">
                                <h:outputLabel class="label-general-po text-lbl-ltr control-label" for="project" value="#{msgs['po.lbl.project.type.required']}"/>
                                <div class="inputText-general-po">
                                    <h:inputText id="project" jsf:placeholder="#{msgs['po.ph.project']}" maxlength="50"
                                                 disabled="#{not permissionBean.hasPermission(300)}"
                                                 value="#{purchaseOrderEdit.poEdit.project}" class="form-control" required="true"
                                                 requiredMessage="#{msgs['po.lbl.project.required']}"/>
                                    <p:message for="project" id="msgProject"/>
                                </div>
                            </div>
                        </div>
                        <div class="section-text-area-po">
                            <p:inputTextarea value="#{purchaseOrderEdit.poEdit.description}"
                                             jsf:placeholder="#{msgs['po.ph.description']}"
                                             maxlength="950"
                                             class="form-control"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="section-lbl-input-po">
                            <div class="form-group input-general-po">
                                <h:outputLabel class="label-general-po text-lbl-ltr control-label" for="po"  value="#{msgs['po.lbl.po.type.required']}"/>
                                <div class="inputText-general-po">
                                    <h:inputText id="po" maxlength="50"  jsf:placeholder="#{msgs['po.ph.po']}"
                                                 value="#{purchaseOrderEdit.poEdit.po}" class="form-control" required="true"
                                                 disabled="#{not permissionBean.hasPermission(301)}"
                                                 requiredMessage="#{msgs['po.lbl.reference.required']}"/>
                                    <p:message for="po" id="msgPo"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="section-lbl-input-po">
                            <div class="form-group input-general-po">
                                <h:outputLabel class="label-general-po text-lbl-ltr control-label" value="#{msgs['po.lbl.variation']}"/>
                                <div class="inputText-general-po">
                                    <h:inputText jsf:placeholder="#{msgs['po.ph.variation']}" maxlength="50"
                                                 value="#{purchaseOrderEdit.poEdit.variation}" class="form-control" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Text input-->

                    <div class="row"><!---->
                        <div class="section-lbl-input-po">
                            <div class="form-group input-general-po">
                                <h:outputLabel  class="label-general-po text-lbl-ltr control-label" value="#{msgs['po.lbl.address']}"/>

                                <div class="inputText-general-po">
                                    <p:inputTextarea maxlength="450" jsf:placeholder="#{msgs['po.ph.address']}"
                                                     style="height: 90px;"
                                                     value="#{purchaseOrderEdit.supplierEdit.address}" class="form-control" />
                                </div>
                            </div>
                        </div>
                        <div class="section-text-area-po">
                                <p:inputTextarea maxlength="950" type="text" value="#{purchaseOrderEdit.supplierEdit.addresDescription}"
                                                 style="height: 90px;"
                                                 jsf:placeholder="#{msgs['po.ph.address.description']}" class="form-control"/>
                            </div>
                    </div>
                <div class="row">
                    <div class="section-lbl-input-po">
                        <div class="form-group input-general-po">
                            <h:outputLabel class="label-general-po text-lbl-ltr control-label" value="#{msgs['po.lbl.supplier']}"/>
                            <div class="inputText-general-po">
                                <h:inputText jsf:placeholder="#{msgs['po.ph.supplier']}"  maxlength="50"
                                             value="#{purchaseOrderEdit.supplierEdit.supplier}" class="form-control" />
                            </div>
                        </div>
                    </div>
                </div>
                    <div class="row">
                        <div class="section-lbl-input-po">
                            <div class="form-group input-general-po">
                                <h:outputLabel class="label-general-po text-lbl-ltr control-label"
                                               value="#{msgs['po.lbl.contact.name']}"/>

                                <div class="inputText-general-po">
                                    <h:inputText maxlength="100" value="#{purchaseOrderEdit.supplierEdit.contactName}"
                                                 jsf:placeholder="#{msgs['po.ph.contact.name']}" class="form-control"/>
                                </div>
                            </div>
                        </div>
                        <div class="section-text-area-po">
                            <p:inputTextarea style="max-height: 29px;"
                                             maxlength="950" value="#{purchaseOrderEdit.supplierEdit.contactNameDescription}"
                                             jsf:placeholder="#{msgs['po.ph.contact.name.description']}" class="form-control"/>
                        </div>
                    </div>
                <div class="row">
                    <div class="section-lbl-input-po">
                        <div class="form-group input-general-po">
                            <h:outputLabel class="label-general-po text-lbl-ltr control-label"
                                           value="#{msgs['po.lbl.po.delivery.date']}"/>

                            <div class="calendar-general-po">
                                <p:calendar value="#{purchaseOrderEdit.poEdit.poDeliveryDate}"
                                            navigator="true" jsf:placeholder="#{configuration.formatDate}"
                                            pattern="#{configuration.formatDate}"
                                            converter="#{dateConverter}"
                                            timeZone="#{configuration.timeZone2}">
                                </p:calendar>
                            </div>
                        </div>
                    </div>
                    <div class="section-text-area-po">
                        <p:inputTextarea style="max-height: 29px;"
                                         maxlength="950" jsf:placeholder="#{msgs['po.ph.delivery.date']}"
                                         value="#{purchaseOrderEdit.poEdit.poDeliveryDateDescription}" class="form-control"/>
                    </div>
                </div>

                    <!-- Text input-->
                    <div class="row">
                        <div class="section-lbl-input-po">
                            <div class="form-group input-general-po">
                                <h:outputLabel class="label-general-po text-lbl-ltr control-label"
                                               value="#{msgs['po.lbl.po.inco.term']}"/>
                                <div class="calendar-general-po">
                                    <p:selectOneMenu id="incoTermSelectOne" value="#{purchaseOrderEdit.poEdit.poIncoTerm}"
                                                     effect="fold" editable="true" styleClass="menu-ddp"
                                                     maxlength="50"  style="width: 100%">
                                        <f:selectItems value="#{incoTerms}"/>
                                    </p:selectOneMenu>
                                </div>
                            </div>
                        </div>
                        <div class="section-text-area-po">
                            <p:inputTextarea style="max-height: 29px;"
                                             maxlength="950" value="#{purchaseOrderEdit.poEdit.poIncoTermDescription}"
                                             jsf:placeholder="#{msgs['po.ph.inco.term.description']}" class="form-control"/>
                        </div>
                    </div>

                <div class="row">
                    <!-- Text input-->
                    <div class="section-lbl-input-po">
                        <div class="form-group input-general-po">
                            <h:outputLabel class="label-general-po text-lbl-ltr control-label" value="#{msgs['po.lbl.po.title']}"/>
                            <div class="inputText-general-po">
                                <h:inputText maxlength="50" value="#{purchaseOrderEdit.poEdit.poTitle}"
                                             jsf:placeholder="#{msgs['po.ph.po.title']}" class="form-control"/>
                            </div>
                        </div>
                    </div>
                </div>
                    <div class="row">
                        <div class="section-lbl-input-po">
                            <div class="form-group input-general-po">
                                <h:outputLabel class="label-general-po text-lbl-ltr control-label"
                                               value="#{msgs['po.lbl.responsible']}"/>
                                <div class="inputText-general-po">
                                    <h:inputText maxlength="100" value="#{purchaseOrderEdit.poEdit.responsibleExpediting}"
                                                 jsf:placeholder="#{msgs['po.ph.responsible']}" class="form-control" />
                                </div>
                            </div>
                        </div>
                        <div class="section-text-area-po">
                            <p:inputTextarea style="max-height: 29px;"
                                             id="responsibleExpeditingObservation"
                                             maxlength="950" type="text"
                                             value="#{purchaseOrderEdit.poEdit.responsibleExpeditingObservation}"
                                             jsf:placeholder="#{msgs['po.ph.responsible.obs']}" class="form-control"/>
                            <p:message for="responsibleExpeditingObservation"/>
                        </div>
                    </div>
                    <ui:include src="components/EditAdditionalData.xhtml"/>
                <div class="clearfix"></div>
                <br/>
                <div style="width: 940px;">
                    <div class="pull-right">
                        <h:commandButton id="save0" value="#{msgs['lbl.update']}" styleClass="btn btn-primary btn-sm"
                                         action="#{purchaseOrderEdit.doUpdate}"
                                         type='submit'/>
                        &#160;
                        <h:commandButton id="cancelCreateBtn0"
                                         value="#{msgs['lbl.cancel']}"
                                         styleClass="btn btn-primary btn-sm">
                            <p:ajax process="@this"
                                    oncomplete="if(hasChanges)PF('confCancelDlg').show();else window.location='../purchase/list.jsf'"/>
                        </h:commandButton>
                    </div>
                    </div>
                    <div class="clearfix"></div>
                    <br/>
                    <div class="row">
                        <ui:include src="components/EditScopeSupply.xhtml"/>
                    </div>
                    <div class="clearfix"></div>
                    <br/>
                    <div class="row">
                        <ui:include src="components/EditAttachments.xhtml"/>
                    </div>
                <div class="clearfix"></div>
                <br/>
                <div class="action-button-po">
                    <div class="pull-right">
                        <h:commandButton id="save" value="#{msgs['lbl.update']}" styleClass="btn btn-primary btn-sm"
                                         action="#{purchaseOrderEdit.doUpdate}"
                                         type='submit'/>
                        &#160;
                        <h:commandButton id="cancelCreateBtn"
                                         value="#{msgs['lbl.cancel']}"
                                         styleClass="btn btn-primary btn-sm">
                            <p:ajax process="@this"
                                    oncomplete="if(hasChanges)PF('confCancelDlg').show();else window.location='../purchase/list.jsf'"/>
                        </h:commandButton>
                    </div>
                </div>
                <div class="clearfix"></div>
                <br/>
                    <p:confirmDialog widgetVar="confCancelDlg" id="confirmDialogId" header="Cancel">
                        <f:facet name="message">
                            <div>
                                <div class="col-md-1">
                                    <h:graphicImage name="img/icon-alert.jpg"/>
                                </div>
                                <div class="col-md-11">
                                    Do you wish to leave this page and lose your unsaved data?
                                    <br/>(including changes to Scopes of Supply).
                                </div>
                            </div>
                        </f:facet>
                        <div class="pull-right">
                            <h:commandButton value="#{msgs['lbl.yes']}" immediate="true"
                                             styleClass="btn btn-primary btn-sm"
                                             action="#{purchaseOrderEdit.cancelEditPurchaseOrder}">
                            </h:commandButton>
                            &#160;
                            <button class="btn btn-primary btn-sm" type="button"
                                    onclick="PF('confCancelDlg').hide();">
                                #{msgs['lbl.no']}
                            </button>
                        </div>
                    </p:confirmDialog>
                </h:form>
            </div>
            <!-- /.col-lg-12 -->
        </div>

    <p:dialog id="commentModalId" header="#{msgs['modal.comment.title']}" widgetVar="commentEditModal" resizable="false" height="250" width="500">
        <ui:include src="modal/EditModalComment.xhtml"/>
    </p:dialog>
    <p:dialog id="commentEditModalId" header="#{msgs['modal.comment.edit.title']}" widgetVar="commentUpdateModal" resizable="false"  height="250" width="500">
        <ui:include src="modal/EditCommentModalUpdate.xhtml"/>
    </p:dialog>
</ui:define>
</ui:composition>
