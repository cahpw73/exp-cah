<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui">

    <h4 class="sub-header fq-sub-header">#{msgs['po.attachments.title']}</h4>
    <div class="fq-form-table">
        <p:dataTable id="commentList" value="#{purchaseOrderEdit.activeComments}" rowIndexVar="_index" var="_comment">
            <p:column headerText="#{msgs['po.attach.tbl.column.date']}" style="width: 20%;" sortBy="#{_comment.lastUpdate}"  sortFunction="#{sortBean.sortDate}" >
                #{util.toLocalDateGMT(_comment.lastUpdate)}
            </p:column>
            <p:column headerText="#{msgs['po.attach.tbl.column.from']}" style="width: 15%;" sortBy="#{_comment.name}" sortFunction="#{sortBean.sortStrings}">
                #{_comment.name}
            </p:column>
            <p:column headerText="#{msgs['po.attach.tbl.column.reason']}" style="width: 15%;" sortBy="#{_comment.reason}"  sortFunction="#{sortBean.sortStrings}">
                #{_comment.reason}
            </p:column>
            <p:column headerText="#{msgs['po.attach.tbl.column.observations']}" style="width: 20%;" sortBy="#{_comment.description}" sortFunction="#{sortBean.sortStrings}">
                #{_comment.description}
            </p:column>
            <p:column headerText="#{msgs['lbl.attachment']}" style="width: 20%;" sortBy="#{_comment.fileName}" sortFunction="#{sortBean.sortStrings}">
                <h:commandLink styleClass="#{not _comment.canDownload()?'disabled':''}" action="#{purchaseOrderEdit.downloadAttachedFileOnComment(_comment.id)}"  disabled="#{not _comment.canDownload()}" value="#{_comment.fileName}"/>
            </p:column>
            <p:column headerText="#{msgs['lbl.action']}" style="width: 30%;">
                <h:commandLink value="#{msgs['lbl.delete']}" styleClass="btn btn-primary btn-sm color-btn-data-table">
                    <p:ajax update="commentList" process="@this" listener="#{purchaseOrderEdit.deleteComment(_comment.id)}"/>
                </h:commandLink>
                &#160;
                <h:commandLink value="#{msgs['lbl.edit']}" styleClass="btn btn-primary btn-sm color-btn-data-table">
                    <p:ajax oncomplete="PF('commentUpdateModal').show();" update=":commentEditFormId" process="@this" listener="#{purchaseOrderEdit.selectComment(_comment.id)}"/>
                </h:commandLink>
            </p:column>
        </p:dataTable>
        <h:commandButton styleClass="component-left btn btn-primary btn-sm" value="#{msgs['lbl.add.comment']}" action="#{purchaseOrderEdit.cleanComment()}" >
            <p:ajax update=":commentModalId" oncomplete="PF('commentEditModal').show();"/>
        </h:commandButton>
    </div>

</ui:composition>
